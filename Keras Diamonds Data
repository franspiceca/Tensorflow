import pandas as pd
import numpy as np
from seaborn import load_dataset 
from sklearn.model_selection import train_test_split
import tensorflow as tf

from seaborn import load_dataset
df = load_dataset("diamonds")
df.head()

#Creating features and target
features = ['cut', 'color', 'clarity', 'carat', 'depth', 'table', 'x', 'y', 'z']
target = 'price'

#Changing to cagtegorical and dropping nulls (preparing for modeling)
df.cut = pd.Categorical(df.cut)
df.color = pd.Categorical(df.color)
df.clarity = pd.Categorical(df.clarity)

df.cut = df.cut.cat.codes
df.color = df.color.cat.codes
df.clarity = df.clarity.cat.codes

df = df.dropna()

df.head()

#Setting up feature and target variables
X = df[features]
y = df[target]

#Training/testing data set up
X_trainval, X_test, y_trainval, y_test = train_test_split(X, y, test_size=0.2, random_state=0)

#Validation data set up
X_train, X_valid, y_train, y_valid = train_test_split(X_trainval, y_trainval, test_size=0.2, random_state=1)
